
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>深入理解RunLoop进阶 | 小川的博客·iXiaoChuan</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="iXiaoChuan">
    

    
    <meta name="description" content="RunLoop 概念RunLoop 概念解释
先来看一下官方文档的定义:
Run loops are part of the fundamental infrastructure associated with threads.A run loop is an event processing loop that you use to schedule work and coordinate th">
<meta property="og:type" content="article">
<meta property="og:title" content="深入理解RunLoop进阶">
<meta property="og:url" content="https://ixiaochuan.top/2018/07/13/深入理解RunLoop进阶/index.html">
<meta property="og:site_name" content="小川的博客·iXiaoChuan">
<meta property="og:description" content="RunLoop 概念RunLoop 概念解释
先来看一下官方文档的定义:
Run loops are part of the fundamental infrastructure associated with threads.A run loop is an event processing loop that you use to schedule work and coordinate th">
<meta property="og:updated_time" content="2018-07-13T09:46:22.229Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="深入理解RunLoop进阶">
<meta name="twitter:description" content="RunLoop 概念RunLoop 概念解释
先来看一下官方文档的定义:
Run loops are part of the fundamental infrastructure associated with threads.A run loop is an event processing loop that you use to schedule work and coordinate th">

    
    <link rel="alternative" href="/atom.xml" title="小川的博客·iXiaoChuan" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="小川的博客·iXiaoChuan" title="小川的博客·iXiaoChuan"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="小川的博客·iXiaoChuan">小川的博客·iXiaoChuan</a></h1>
				<h2 class="blog-motto">零散知识整理、技术脉络总结、工作人生规划</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/categories">分类</a></li>
					
						<li><a href="/tags">标签</a></li>
					
						<li><a href="/about">关于</a></li>
					
						<li><a href="/usedapp">常用软件</a></li>
					
					<li>
 					
						<form class="search" action="http://ixiaochuan.top" target="_blank">
							<label>Search</label>
						<input name="s" type="hidden" value= 10090999781559433000 ><input type="text" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/07/13/深入理解RunLoop进阶/" title="深入理解RunLoop进阶" itemprop="url">深入理解RunLoop进阶</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="iXiaoChuan" target="_blank" itemprop="author">iXiaoChuan</a>
		
  <p class="article-time">
    <time datetime="2018-07-13T02:36:33.000Z" itemprop="datePublished"> 发表于 07-13-2018</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#RunLoop-概念"><span class="toc-number">1.</span> <span class="toc-text">RunLoop 概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RunLoop-概念解释"><span class="toc-number">1.1.</span> <span class="toc-text">RunLoop 概念解释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RunLoop-核心技术"><span class="toc-number">1.2.</span> <span class="toc-text">RunLoop 核心技术</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RunLoop-构成详解"><span class="toc-number">1.3.</span> <span class="toc-text">RunLoop 构成详解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RunLoop-Modes"><span class="toc-number">1.3.1.</span> <span class="toc-text">RunLoop Modes </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RunLoop-Source"><span class="toc-number">1.3.2.</span> <span class="toc-text">RunLoop Source </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RunLoop-Timer"><span class="toc-number">1.3.3.</span> <span class="toc-text">RunLoop Timer </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RunLoop-Observer"><span class="toc-number">1.3.4.</span> <span class="toc-text">RunLoop Observer </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RunLoop-运行机制"><span class="toc-number">1.4.</span> <span class="toc-text">RunLoop 运行机制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RunLoop-官方的应用"><span class="toc-number">2.</span> <span class="toc-text">RunLoop 官方的应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RunLoop-开发中实践"><span class="toc-number">3.</span> <span class="toc-text">RunLoop 开发中实践</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#引申概念解释"><span class="toc-number">4.</span> <span class="toc-text">引申概念解释</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#①进程"><span class="toc-number">4.1.</span> <span class="toc-text">①进程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文献"><span class="toc-number">5.</span> <span class="toc-text">参考文献</span></a></li></ol>
		
		</div>
		
		<h2 id="RunLoop-概念"><a href="#RunLoop-概念" class="headerlink" title="RunLoop 概念"></a>RunLoop 概念</h2><h3 id="RunLoop-概念解释"><a href="#RunLoop-概念解释" class="headerlink" title="RunLoop 概念解释"></a>RunLoop 概念解释</h3><blockquote>
<p>先来看一下官方文档的定义:</p>
<p>Run loops are part of the fundamental infrastructure associated with threads.A run loop is an event processing loop that you use to schedule work and coordinate the receipt of incoming events. The purpose of a run loop is to keep your thread busy when there is work to do and put your thread to sleep when there is none.</p>
<p>RunLoop是与线程相关的系统基础框架的一部分。而RunLoop的作用，顾名思义就是用来接收、协调所传入事件的”事件处理循环”。RunLoop目的就是让线程在有任务的时候努力工作，在没有任务的时候进入休眠。</p>
</blockquote>
<p>有没有接地气一点的解释？有。RunLoop说白了就是一个一直运行着的循环(带条件)。跟我们平常经常使用的for循环类似，只是RunLoop采用了一些特殊的机制用来处理系统的事件了。</p>
<p>从Spring board上点击一个App图标启动这个App开始，这个App就可以进行接收用户操作、跟远程服务器进行网络数据交换、将数据展示到各种类型的视图上去……系统是怎么实现这些操作的呢？原理就是系统给运行的App分配了<a href="#process">进程<sup>①</sup></a>。</p>
<p>RunLoop存在的意义是什么?</p>
<h3 id="RunLoop-核心技术"><a href="#RunLoop-核心技术" class="headerlink" title="RunLoop 核心技术"></a>RunLoop 核心技术</h3><h3 id="RunLoop-构成详解"><a href="#RunLoop-构成详解" class="headerlink" title="RunLoop 构成详解"></a>RunLoop 构成详解</h3><h4 id="RunLoop-Modes"><a href="#RunLoop-Modes" class="headerlink" title="RunLoop Modes "></a>RunLoop Modes <!-- CFRunLoopSource --></h4><h4 id="RunLoop-Source"><a href="#RunLoop-Source" class="headerlink" title="RunLoop Source "></a>RunLoop Source <!-- CFRunLoopSource --></h4><h4 id="RunLoop-Timer"><a href="#RunLoop-Timer" class="headerlink" title="RunLoop Timer "></a>RunLoop Timer <!-- CFRunLoopTimer --></h4><h4 id="RunLoop-Observer"><a href="#RunLoop-Observer" class="headerlink" title="RunLoop Observer "></a>RunLoop Observer <!-- CFRunLoopObserver --></h4><h3 id="RunLoop-运行机制"><a href="#RunLoop-运行机制" class="headerlink" title="RunLoop 运行机制"></a>RunLoop 运行机制</h3><h2 id="RunLoop-官方的应用"><a href="#RunLoop-官方的应用" class="headerlink" title="RunLoop 官方的应用"></a>RunLoop 官方的应用</h2><h2 id="RunLoop-开发中实践"><a href="#RunLoop-开发中实践" class="headerlink" title="RunLoop 开发中实践"></a>RunLoop 开发中实践</h2><h2 id="引申概念解释"><a href="#引申概念解释" class="headerlink" title="引申概念解释"></a>引申概念解释</h2><h3 id="①进程"><a href="#①进程" class="headerlink" title="①进程"></a><font size="3"><span id="process">①进程</span><font></font></font></h3><p><font size="2">进程是计算机科学的一个基础概念.是计算机中一个具有独立功能的程序关于某个数据集合的一次运行活动。进程其实就是程序处理任务的实例，进程还可以包含多个线程，而线程就是处理某个具体任务的实例。接地气点解释就是：程序相当于一个工厂，而进程就是生产车间，而线程就是生产线；正常状态下，一个工厂可以有多个生产车间，一个生产车间可以有多条生产线；而每个车间具体生成某个产品，而每条生产线具体生产产品的某个部件，大概就是这么个意思。<font></font></font></p>
<p><font size="2">线程才是处理具体任务的对象，开启多线程的原因就是为了防止线程的堵塞，比方说处理界面更新操作、处理大批计算操作如果同步进行，CPU同步处理，就可能会出现CPU忙不过来造成界面卡顿的问题，而给每个任务开单独的线程，就可以将任务异步进行，不会彼此影响（CPU允许范围内）。接地气点解释就是：就有点类似于生产车间生产摩拜（摩拜请付给我广告费~）自行车，如果只有一条生产线（线程），就只能车把、车轮、链条……这样一个部分等着另一部分完成再继续生产的进行；而有多条生产线，就可以同时生产各个部分，最后组装即可。<font></font></font></p>
<p><font size="2">而当下的移动端开发同样的也采用了类似的操作。但是Android系统和iOS系统还有点不太一样，Android系统可以给一个App开启多个进程，而在iOS中一个App只能开启一个进程。但是线程都是同样的，可以开启多个。而一般情况下一个线程只能执行一个任务，执行完毕就会退出销毁。但是不行啊，有时候我们需要一个线程一直运行着，不管有没有任务，需要它等着随时有任务的到来（App主线程），所以才有了这么一个机制叫做时间循环，iOS中叫做RunLoop，Android中大概叫Looper。<font></font></font></p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2>  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/旧知新解/">旧知新解</a>►<a class="article-category-link" href="/categories/旧知新解/学习笔记/">学习笔记</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/iOS进阶/">iOS进阶</a><a href="/tags/Runloop/">Runloop</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="https://ixiaochuan.top/2018/07/13/深入理解RunLoop进阶/" data-title="深入理解RunLoop进阶 | 小川的博客·iXiaoChuan" data-tsina="3051719850" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 

<div class="next">
<a href="/2018/06/27/Runtime给类别添加属性/"  title="Runtime给类别添加属性">
 <strong>下一篇：</strong><br/> 
 <span>Runtime给类别添加属性
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2018/07/13/深入理解RunLoop进阶/" data-title="深入理解RunLoop进阶" data-url="https://ixiaochuan.top/2018/07/13/深入理解RunLoop进阶/"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#RunLoop-概念"><span class="toc-number">1.</span> <span class="toc-text">RunLoop 概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RunLoop-概念解释"><span class="toc-number">1.1.</span> <span class="toc-text">RunLoop 概念解释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RunLoop-核心技术"><span class="toc-number">1.2.</span> <span class="toc-text">RunLoop 核心技术</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RunLoop-构成详解"><span class="toc-number">1.3.</span> <span class="toc-text">RunLoop 构成详解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RunLoop-Modes"><span class="toc-number">1.3.1.</span> <span class="toc-text">RunLoop Modes </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RunLoop-Source"><span class="toc-number">1.3.2.</span> <span class="toc-text">RunLoop Source </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RunLoop-Timer"><span class="toc-number">1.3.3.</span> <span class="toc-text">RunLoop Timer </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RunLoop-Observer"><span class="toc-number">1.3.4.</span> <span class="toc-text">RunLoop Observer </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RunLoop-运行机制"><span class="toc-number">1.4.</span> <span class="toc-text">RunLoop 运行机制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RunLoop-官方的应用"><span class="toc-number">2.</span> <span class="toc-text">RunLoop 官方的应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RunLoop-开发中实践"><span class="toc-number">3.</span> <span class="toc-text">RunLoop 开发中实践</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#引申概念解释"><span class="toc-number">4.</span> <span class="toc-text">引申概念解释</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#①进程"><span class="toc-number">4.1.</span> <span class="toc-text">①进程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文献"><span class="toc-number">5.</span> <span class="toc-text">参考文献</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="iXiaoChuan" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>
  </div>



  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/iOS进阶/" title="iOS进阶">iOS进阶<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/iOS优化/" title="iOS优化">iOS优化<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Python学习/" title="Python学习">Python学习<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Runloop/" title="Runloop">Runloop<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/2017年度规划/" title="2017年度规划">2017年度规划<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/WKWebview/" title="WKWebview">WKWebview<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Runtime/" title="Runtime">Runtime<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/单元测试/" title="单元测试">单元测试<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/博客阅读笔记/" title="博客阅读笔记">博客阅读笔记<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/2018年度规划/" title="2018年度规划">2018年度规划<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/属性/" title="属性">属性<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/蓝牙/" title="蓝牙">蓝牙<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://pingguohe.net" target="_blank" title="阿里技术团队">阿里技术团队</a>
            
          </li>
        
          <li>
            
            	<a href="https://tech.meituan.com" target="_blank" title="美团点评技术团队">美团点评技术团队</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.jianshu.com/p/49bc447cad19?from=timeline&isappinstalled=0" target="_blank" title="iOS各大技术团队博客汇总">iOS各大技术团队博客汇总</a>
            
          </li>
        
          <li>
            
            	<a href="https://github.com/tangqiaoboy/iOSBlogCN" target="_blank" title="iOS前沿开发者_博客集">iOS前沿开发者_博客集</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.jianshu.com/c/49bfa36740cc" target="_blank" title="iOS进阶指南_博客集">iOS进阶指南_博客集</a>
            
          </li>
        
    </ul>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Welcome to XiaoChuan&#39;s blog~ <br/>
			@iXiaoChuan PersonalBlog.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/3051719850" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/iXiaoChuan" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		<a href="http://www.zhihu.com/people/iXiaoChuan" target="_blank" class="icon-zhihu" title="知乎"></a>
		
		
		
		<a href="mailto:xiaochuan171090331@outlook.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2018 
		
		<a href="/about" target="_blank" title="iXiaoChuan">iXiaoChuan</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"ixiaochuan"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
